*Start
  # Variables
  *Parameter
    base_path = '/mnt/brunodata/pet'
    proj = 'ds004513'
    sub_id = 's003'
    ses_id = 'open'
    other_ses_id = 'closed'
    
  # Sink location
  *Sink
    ${base_path}/${proj}/derivatives/picnic/sub-${sub_id}/ses-${ses_id}
  
  # MRI Imports
  *Import, name=ses-${ses_id}_mri, Method=nibabel
    ${base_path}/${proj}/sub-${sub_id}/ses-${ses_id}/anat/sub-${sub_id}_ses-${ses_id}_T1w.nii.gz
  *Import, name=ses-${other_ses_id}_mri, Method=nibabel
    ${base_path}/${proj}/sub-${sub_id}/ses-${other_ses_id}/anat/sub-${sub_id}_ses-${other_ses_id}_T1w.nii.gz
    
  # PET Imports
  *Import, name=ses-${ses_id}_pet, Method=nibabel
    ${base_path}/${proj}/sub-${sub_id}/ses-${ses_id}/pet/sub-${sub_id}_ses-${ses_id}_task-rest_pet.nii.gz
    
  # Modules
  *Reconall, name=ses-${sub_id}_reconall, Status=Execute
    @ses-${ses_id}_mri.ses-${ses_id}_mri
    @ses-${other_ses_id}_mri.ses-${other_ses_id}_mri
  *Motion Correction, Name=ses-${ses_id}_moco, Type=mcflirt, Ref Vol=8, Smooth=4, Crop Start=4
    @ses-${ses_id}_pet.ses-${ses_id}_pet
  *Camra, Name=ses-${ses_id}_coreg, Type=LCF, DOF=6, Cost=mutualinfo
    @ses-${ses_id}_moco.ses-${ses_id}_moco
    @ses-${ses_id}_reconall.T1
    @ses-${ses_id}_reconall.brainmask
    @ses-${ses_id}_reconall.wm_mask
    @ses-${ses_id}_reconall.gm_mask
  *TACs, name=ses-${ses_id}_tacs
    @ses-${ses_id}_coreg.ses-${ses_id}_coreg
    @ses-${ses_id}_reconall.bilateral_wmparc
    
*End
